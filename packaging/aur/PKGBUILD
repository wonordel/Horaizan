# Maintainer: wonordel <megorka2014@gmail.com>

pkgname=horaizan
pkgver=v1.0
pkgrel=1
pkgdesc="Chromium-based browser built with PySide6"
arch=('x86_64')
url="https://github.com/wonordel/Horaizan"
license=('custom')
depends=(
  'python'
  'pyside6'
  'qt6-webengine'
  'hicolor-icon-theme'
)
optdepends=(
  'xdg-utils: set as default browser via xdg-settings'
)
conflicts=('horaizan-git')
provides=('horaizan-git')
install='horaizan.install'

_commit='f82ce6f'
source=(
  "${pkgname}-${pkgver}.tar.gz::https://github.com/wonordel/Horaizan/archive/${_commit}.tar.gz"
  'app-main-argv.patch'
  'session-and-pdf.patch'
  'horaizan'
  'horaizan.desktop'
)
sha256sums=(
  'SKIP'
  'SKIP'
  'SKIP'
  'SKIP'
  'SKIP'
)

prepare() {
  cd "${srcdir}/Horaizan-${_commit}"
  patch -Np1 -i "${srcdir}/app-main-argv.patch"
  patch -Np1 -i "${srcdir}/session-and-pdf.patch"
}

package() {
  cd "${srcdir}/Horaizan-${_commit}"

  install -dm755 "${pkgdir}/usr/lib/horaizan"
  cp -r app "${pkgdir}/usr/lib/horaizan/"

  install -Dm755 "${srcdir}/horaizan" "${pkgdir}/usr/bin/horaizan"
  install -Dm644 "${srcdir}/horaizan.desktop" "${pkgdir}/usr/share/applications/horaizan.desktop"
  install -Dm644 "app/themes/icon.png" "${pkgdir}/usr/share/icons/hicolor/256x256/apps/horaizan.png"

  install -Dm644 README.md "${pkgdir}/usr/share/doc/horaizan/README.md"
}
